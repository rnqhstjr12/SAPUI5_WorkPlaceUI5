//Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/integration/Host","sap/ui/model/json/JSONModel","sap/ushell/Container","sap/ushell/EventHub","sap/ui/model/resource/ResourceModel"],function(e,t,r,o,n){"use strict";return function(a,s){var i=new e(a,s);i._oHostContext=null;i._oHostContextModel=null;i.setResolveDestination(function(e){if(!e){return Promise.reject()}return Promise.resolve(location.origin+"/dynamic_dest/"+e)});i.attachCardInitialized(function(e){var t=e.getParameter("card");if(t&&t.isA&&t.isA("sap.ui.integration.widgets.Card")){o.emit("UITracer.trace",{source:"Card",reason:"Init",data:{cardId:t.getManifestEntry("/sap.app/id"),providerId:t.getReferenceId()}})}});i._setContainer=function(e){this.oContainer=e};i._setNavigationDisabled=function(e){this._bNavigationDisabled=!!e};i._executeNavigation=function(e){var t=e.getParameter("parameters"),r=e.getParameter("card");if(e.getParameter("type")!=="Navigation"||this._bNavigationDisabled){return Promise.resolve()}if(t&&t.hasOwnProperty("url")){o.emit("UITracer.trace",{reason:"LaunchApp",source:"Card",data:{cardId:r.getManifestEntry("/sap.app/id"),providerId:r.getReferenceId(),targetUrl:t.url}});return Promise.resolve()}e.preventDefault(true);return this.oContainer.getServiceAsync("Navigation").then(function(e){var n={};if(t.hasOwnProperty("ibnTarget")){n.target=t.ibnTarget}if(t.hasOwnProperty("ibnParams")){n.params=t.ibnParams}if(t.hasOwnProperty("ibnAppSpecificRoute")){n.appSpecificRoute=t.ibnAppSpecificRoute}o.emit("UITracer.trace",{reason:"LaunchApp",source:"Card",data:{cardId:r.getManifestEntry("/sap.app/id"),providerId:r.getReferenceId(),targetUrl:"#"+n.target.semanticObject+"-"+n.target.action}});return e.navigate(n)})};i.attachAction(i._executeNavigation.bind(i));i.fetch=function(t,r,n,a){if(a&&a.isA&&a.isA("sap.ui.integration.widgets.Card")){return e.prototype.fetch.apply(this,arguments).then(function(e){o.emit("UITracer.trace",{source:"Card",reason:"FetchData",data:{cardId:a.getManifestEntry("/sap.app/id"),providerId:a.getReferenceId(),targetUrl:t,status:e.status}});return e})}return e.prototype.fetch.apply(this,arguments)};i.getContextValue=function(e){try{if(!e){return Promise.reject()}if(e.charAt(0)==="/"){return i.getContextValue(e.substring(1))}return i.getContext().then(function(){return i._oHostContextModel.getProperty("/"+e)})}catch(e){return Promise.resolve()}};i.getContext=function(){if(!i._oHostContext){i._oHostContext=r.getServiceAsync("UserInfo").then(function(e){return i._getBundle().then(function(t){return i._applyHostContext(e,t)}).catch(function(){return i._applyHostContext(e)})}).catch(function(){return{}})}return Promise.resolve(i._oHostContext)};i._getBundle=function(){return new n({bundleName:"sap.ushell.utils.workpage.resources.resources",async:true}).getResourceBundle()};i._applyHostContext=function(e,r){if(!r){r={getText:function(e){return e}}}i._oHostContext={"sap.workzone":{label:r.getText("WorkPage.Host.Context.WorkZone.Label"),currentUser:{label:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.Label"),id:{label:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.Id.Label"),type:"string",tags:["technical"],placeholder:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.Id.Placeholder"),description:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.Id.Desc"),value:e.getId()},name:{label:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.Name.Label"),type:"string",placeholder:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.Name.Placeholder"),description:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.Name.Desc"),value:e.getFullName()},firstName:{label:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.FirstName.Label"),type:"string",placeholder:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.FirstName.Placeholder"),description:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.FirstName.Desc"),value:e.getFirstName()},lastName:{label:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.LastName.Label"),type:"string",placeholder:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.LastName.Placeholder"),description:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.LastName.Desc"),value:e.getLastName()},email:{label:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.Email.Label"),type:"string",placeholder:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.Email.Placeholder"),description:r.getText("WorkPage.Host.Context.WorkZone.CurrentUser.Email.Desc"),value:e.getEmail()}}}};i._oHostContextModel=new t(i._oHostContext);return i._oHostContext};return i}});
//# sourceMappingURL=WorkPageHost.js.map